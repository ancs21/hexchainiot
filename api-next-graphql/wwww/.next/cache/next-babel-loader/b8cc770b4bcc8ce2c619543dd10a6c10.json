{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport { ApolloClient, InMemoryCache } from 'apollo-boost';\nimport { createHttpLink } from 'apollo-link-http';\nimport { setContext } from 'apollo-link-context';\nimport fetch from 'isomorphic-unfetch';\nlet apolloClient = null; // Polyfill fetch() on the server (used by apollo-client)\n\nif (typeof window === 'undefined') {\n  global.fetch = fetch;\n}\n\nfunction create(initialState, {\n  getToken,\n  fetchOptions\n}) {\n  const httpLink = createHttpLink({\n    uri: 'http://localhost:3000/graphql',\n    credentials: 'same-origin',\n    fetchOptions\n  });\n  const authLink = setContext((_, {\n    headers\n  }) => {\n    const token = getToken();\n    return {\n      headers: _objectSpread({}, headers, {\n        authorization: token ? `Bearer ${token}` : ''\n      })\n    };\n  }); // Check out https://github.com/zeit/next.js/pull/4611 if you want to use the AWSAppSyncClient\n\n  const isBrowser = typeof window !== 'undefined';\n  return new ApolloClient({\n    connectToDevTools: isBrowser,\n    ssrMode: !isBrowser,\n    // Disables forceFetch on the server (so queries are only run once)\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache().restore(initialState || {})\n  });\n}\n\nexport default function initApollo(initialState, options) {\n  // Make sure to create a new client for every server-side request so that data\n  // isn't shared between connections (which would be bad)\n  if (typeof window === 'undefined') {\n    let fetchOptions = {}; // If you are using a https_proxy, add fetchOptions with 'https-proxy-agent' agent instance\n    // 'https-proxy-agent' is required here because it's a sever-side only module\n\n    if (process.env.https_proxy) {\n      fetchOptions = {\n        agent: new (require('https-proxy-agent'))(process.env.https_proxy)\n      };\n    }\n\n    return create(initialState, _objectSpread({}, options, {\n      fetchOptions\n    }));\n  } // Reuse client on the client-side\n\n\n  if (!apolloClient) {\n    apolloClient = create(initialState, options);\n  }\n\n  return apolloClient;\n}","map":{"version":3,"sources":["/home/xadmin/Desktop/hexchain/hexchainiot/api-next-graphql/wwww/lib/init-apollo.js"],"names":["ApolloClient","InMemoryCache","createHttpLink","setContext","fetch","apolloClient","window","global","create","initialState","getToken","fetchOptions","httpLink","uri","credentials","authLink","_","headers","token","authorization","isBrowser","connectToDevTools","ssrMode","link","concat","cache","restore","initApollo","options","process","env","https_proxy","agent","require"],"mappings":";AAAA,SAASA,YAAT,EAAuBC,aAAvB,QAA4C,cAA5C;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,UAAT,QAA2B,qBAA3B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AAEA,IAAIC,YAAY,GAAG,IAAnB,C,CAEA;;AACA,IAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;AACjCC,EAAAA,MAAM,CAACH,KAAP,GAAeA,KAAf;AACD;;AAED,SAASI,MAAT,CAAgBC,YAAhB,EAA8B;AAAEC,EAAAA,QAAF;AAAYC,EAAAA;AAAZ,CAA9B,EAA0D;AACxD,QAAMC,QAAQ,GAAGV,cAAc,CAAC;AAC9BW,IAAAA,GAAG,EAAE,+BADyB;AAE9BC,IAAAA,WAAW,EAAE,aAFiB;AAG9BH,IAAAA;AAH8B,GAAD,CAA/B;AAMA,QAAMI,QAAQ,GAAGZ,UAAU,CAAC,CAACa,CAAD,EAAI;AAAEC,IAAAA;AAAF,GAAJ,KAAoB;AAC9C,UAAMC,KAAK,GAAGR,QAAQ,EAAtB;AACA,WAAO;AACLO,MAAAA,OAAO,oBACFA,OADE;AAELE,QAAAA,aAAa,EAAED,KAAK,GAAI,UAASA,KAAM,EAAnB,GAAuB;AAFtC;AADF,KAAP;AAMD,GAR0B,CAA3B,CAPwD,CAiBxD;;AACA,QAAME,SAAS,GAAG,OAAOd,MAAP,KAAkB,WAApC;AACA,SAAO,IAAIN,YAAJ,CAAiB;AACtBqB,IAAAA,iBAAiB,EAAED,SADG;AAEtBE,IAAAA,OAAO,EAAE,CAACF,SAFY;AAED;AACrBG,IAAAA,IAAI,EAAER,QAAQ,CAACS,MAAT,CAAgBZ,QAAhB,CAHgB;AAItBa,IAAAA,KAAK,EAAE,IAAIxB,aAAJ,GAAoByB,OAApB,CAA4BjB,YAAY,IAAI,EAA5C;AAJe,GAAjB,CAAP;AAMD;;AAED,eAAe,SAASkB,UAAT,CAAoBlB,YAApB,EAAkCmB,OAAlC,EAA2C;AACxD;AACA;AACA,MAAI,OAAOtB,MAAP,KAAkB,WAAtB,EAAmC;AACjC,QAAIK,YAAY,GAAG,EAAnB,CADiC,CAEjC;AACA;;AACA,QAAIkB,OAAO,CAACC,GAAR,CAAYC,WAAhB,EAA6B;AAC3BpB,MAAAA,YAAY,GAAG;AACbqB,QAAAA,KAAK,EAAE,KAAKC,OAAO,CAAC,mBAAD,CAAZ,EAAmCJ,OAAO,CAACC,GAAR,CAAYC,WAA/C;AADM,OAAf;AAGD;;AACD,WAAOvB,MAAM,CAACC,YAAD,oBACRmB,OADQ;AAEXjB,MAAAA;AAFW,OAAb;AAID,GAhBuD,CAkBxD;;;AACA,MAAI,CAACN,YAAL,EAAmB;AACjBA,IAAAA,YAAY,GAAGG,MAAM,CAACC,YAAD,EAAemB,OAAf,CAArB;AACD;;AAED,SAAOvB,YAAP;AACD","sourcesContent":["import { ApolloClient, InMemoryCache } from 'apollo-boost'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport fetch from 'isomorphic-unfetch'\n\nlet apolloClient = null\n\n// Polyfill fetch() on the server (used by apollo-client)\nif (typeof window === 'undefined') {\n  global.fetch = fetch\n}\n\nfunction create(initialState, { getToken, fetchOptions }) {\n  const httpLink = createHttpLink({\n    uri: 'http://localhost:3000/graphql',\n    credentials: 'same-origin',\n    fetchOptions\n  })\n\n  const authLink = setContext((_, { headers }) => {\n    const token = getToken()\n    return {\n      headers: {\n        ...headers,\n        authorization: token ? `Bearer ${token}` : ''\n      }\n    }\n  })\n\n  // Check out https://github.com/zeit/next.js/pull/4611 if you want to use the AWSAppSyncClient\n  const isBrowser = typeof window !== 'undefined'\n  return new ApolloClient({\n    connectToDevTools: isBrowser,\n    ssrMode: !isBrowser, // Disables forceFetch on the server (so queries are only run once)\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache().restore(initialState || {})\n  })\n}\n\nexport default function initApollo(initialState, options) {\n  // Make sure to create a new client for every server-side request so that data\n  // isn't shared between connections (which would be bad)\n  if (typeof window === 'undefined') {\n    let fetchOptions = {}\n    // If you are using a https_proxy, add fetchOptions with 'https-proxy-agent' agent instance\n    // 'https-proxy-agent' is required here because it's a sever-side only module\n    if (process.env.https_proxy) {\n      fetchOptions = {\n        agent: new (require('https-proxy-agent'))(process.env.https_proxy)\n      }\n    }\n    return create(initialState, {\n      ...options,\n      fetchOptions\n    })\n  }\n\n  // Reuse client on the client-side\n  if (!apolloClient) {\n    apolloClient = create(initialState, options)\n  }\n\n  return apolloClient\n}\n"]},"metadata":{},"sourceType":"module"}