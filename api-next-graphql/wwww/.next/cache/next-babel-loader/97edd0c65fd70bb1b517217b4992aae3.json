{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport React, { useState, useEffect, useContext, createContext } from 'react';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport Cookies from 'js-cookie';\nvar config = {\n  apiKey: 'AIzaSyBtAOTryp1Fmv93HM1qR6j62UNkyfs7aqU',\n  authDomain: 'hexchainiot.firebaseapp.com',\n  databaseURL: 'https://hexchainiot.firebaseio.com',\n  projectId: 'hexchainiot',\n  storageBucket: '',\n  messagingSenderId: '581192912622',\n  appId: '1:581192912622:web:5708ef67b226104c'\n};\n!firebase.apps.length ? firebase.initializeApp(config) : firebase.app();\nvar authContext = createContext();\nexport function ProvideAuth(_ref) {\n  var children = _ref.children;\n  var auth = useProvideAuth();\n  return React.createElement(authContext.Provider, {\n    value: auth\n  }, children);\n}\nexport var useAuth = function useAuth() {\n  return useContext(authContext);\n};\nexport { firebase };\n\nfunction useProvideAuth() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var signout = function signout() {\n    return firebase.auth().signOut().then(function () {\n      setUser(false);\n      localStorage.removeItem('token');\n    });\n  };\n\n  useEffect(function () {\n    var unsubscribe = firebase.auth().onAuthStateChanged(\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(user) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!user) {\n                  _context.next = 15;\n                  break;\n                }\n\n                setUser(user);\n                _context.t0 = localStorage;\n                _context.next = 5;\n                return firebase.auth().currentUser.getIdToken(\n                /* forceRefresh */\n                true);\n\n              case 5:\n                _context.t1 = _context.sent;\n\n                _context.t0.setItem.call(_context.t0, 'token', _context.t1);\n\n                _context.t2 = Cookies;\n                _context.next = 10;\n                return firebase.auth().currentUser.getIdToken(\n                /* forceRefresh */\n                true);\n\n              case 10:\n                _context.t3 = _context.sent;\n\n                _context.t2.set.call(_context.t2, 'token', _context.t3);\n\n                setLoading(false);\n                _context.next = 17;\n                break;\n\n              case 15:\n                setUser(false);\n                setLoading(false);\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }()); // Cleanup subscription on unmount\n\n    return function () {\n      return unsubscribe();\n    };\n  }, []); // Return the user object and auth methods\n\n  return {\n    user: user,\n    isLoading: isLoading,\n    signout: signout\n  };\n}","map":{"version":3,"sources":["/home/xadmin/Desktop/hexchain/hexchainiot/api-next-graphql/wwww/components/use-auth.js"],"names":["React","useState","useEffect","useContext","createContext","firebase","Cookies","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","apps","length","initializeApp","app","authContext","ProvideAuth","children","auth","useProvideAuth","useAuth","user","setUser","isLoading","setLoading","signout","signOut","then","localStorage","removeItem","unsubscribe","onAuthStateChanged","currentUser","getIdToken","setItem","set"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext, createContext } from 'react'\nimport * as firebase from 'firebase/app'\nimport 'firebase/auth'\nimport Cookies from 'js-cookie'\n\nconst config = {\n  apiKey: 'AIzaSyBtAOTryp1Fmv93HM1qR6j62UNkyfs7aqU',\n  authDomain: 'hexchainiot.firebaseapp.com',\n  databaseURL: 'https://hexchainiot.firebaseio.com',\n  projectId: 'hexchainiot',\n  storageBucket: '',\n  messagingSenderId: '581192912622',\n  appId: '1:581192912622:web:5708ef67b226104c'\n}\n!firebase.apps.length ? firebase.initializeApp(config) : firebase.app()\n\nconst authContext = createContext()\n\nexport function ProvideAuth({ children }) {\n  const auth = useProvideAuth()\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>\n}\n\nexport const useAuth = () => {\n  return useContext(authContext)\n}\n\nexport { firebase }\n\nfunction useProvideAuth() {\n  const [user, setUser] = useState(null)\n  const [isLoading, setLoading] = useState(true)\n  const signout = () => {\n    return firebase\n      .auth()\n      .signOut()\n      .then(() => {\n        setUser(false)\n        localStorage.removeItem('token')\n      })\n  }\n\n  useEffect(() => {\n    const unsubscribe = firebase.auth().onAuthStateChanged(async user => {\n      if (user) {\n        setUser(user)\n        localStorage.setItem(\n          'token',\n          await firebase.auth().currentUser.getIdToken(/* forceRefresh */ true)\n        )\n        Cookies.set(\n          'token',\n          await firebase.auth().currentUser.getIdToken(/* forceRefresh */ true)\n        )\n        setLoading(false)\n      } else {\n        setUser(false)\n        setLoading(false)\n      }\n    })\n\n    // Cleanup subscription on unmount\n    return () => unsubscribe()\n  }, [])\n\n  // Return the user object and auth methods\n  return {\n    user,\n    isLoading,\n    signout\n  }\n}\n"]},"metadata":{},"sourceType":"module"}